# ARX CLI Commands Reference

## Overview
This document provides all the command-line interface commands for building and executing ARX programs.

## ðŸŽ¯ **Current Capabilities - ALL WORKING!**

### âœ… **Complete AST-Based Architecture**
- **Dynamic Value Processing**: All values captured from source code in AST nodes
- **No Hardcoded Values**: Compiler generates code based on actual parsed expressions
- **Runtime Calculation**: VM performs all calculations using values from AST
- **C-Style Syntax**: Modern variable declarations and assignments
- **CODE Section Loading**: VM successfully loads and executes bytecode

### âœ… **Fully Working Features**
- **String Output**: `writeln('Hello, World!')` âœ… Working
- **Arithmetic Expressions**: `result = (2000 * 3) / 4` âœ… Working (Result: 1500)
- **String Concatenation**: `writeln('Result: ' + result)` âœ… Working
- **Variable Management**: `string str; str = 'Hello';` âœ… Working
- **Type Conversion**: Automatic integer-to-string conversion âœ… Working
- **Symbol Table**: Complete variable management âœ… Working
- **Complex Expressions**: `(2000 * 3) / 4 = 1500` âœ… Working
- **Multiple Statements**: All writeln statements execute âœ… Working

## Prerequisites
Make sure you have built the ARX tools:
```bash
# Build the compiler
cd /Users/matthewwhite/Code/arx/build
make

# Build the VM
cd /Users/matthewwhite/Code/arx/vm
make
```

## Tool Locations
- **Compiler**: `/Users/matthewwhite/Code/arx/arx`
- **VM**: `/Users/matthewwhite/Code/arx/arxvm`
- **Module Inspector**: `/Users/matthewwhite/Code/arx/arxmod_info`

## Compiler Commands

### Basic Compilation
```bash
# Compile ARX source to bytecode
cd /Users/matthewwhite/Code/arx
./arx program.arx

# Compile with specific output file
./arx -o output.arxmod program.arx
```

### Debug Compilation
```bash
# Enable debug output
./arx -debug program.arx

# Show generated bytecode
./arx -debug -show-bytecode program.arx

# Show symbol table
./arx -debug -show-symbols program.arx

# Show all debug information
./arx -debug -show-bytecode -show-symbols program.arx
```

### Compiler Options
- `-debug`: Enable debug output
- `-show-bytecode`: Display generated bytecode instructions
- `-show-symbols`: Display symbol table contents
- `-o <file>`: Specify output file name

## VM Commands

### Basic Execution
```bash
# Execute ARX bytecode
cd /Users/matthewwhite/Code/arx
./arxvm program.arxmod

# Execute with debug output
./arxvm -debug program.arxmod
```

### VM Debug Options
```bash
# Step through execution
cd /Users/matthewwhite/Code/arx
./arxvm -debug -step program.arxmod

# Show memory state
./arxvm -debug -dump program.arxmod

# Trace execution
./arxvm -debug -trace program.arxmod
```

### VM Options
- `-debug`: Enable VM debug output
- `-step`: Step through execution
- `-dump`: Show memory state
- `-trace`: Trace execution

## Module Inspection Commands

### ARX Module Information
```bash
# Show module sections
cd /Users/matthewwhite/Code/arx/build
./arxmod_info -sections program.arxmod

# Show hex dump
./arxmod_info -hex program.arxmod

# Show module information
./arxmod_info -info program.arxmod
```

### Module Inspector Options
- `-sections`: Display section information
- `-hex`: Display hex dump of module
- `-info`: Display module header information

## Complete Workflow Examples

### Example 1: Basic Compilation and Execution
```bash
# 1. Create a simple ARX program
cat > hello.arx << 'EOF'
module HelloWorld;

class App
  procedure Main
  begin
    WriteLn('Hello, World!');
  end;
end;
EOF

# 2. Compile the program
cd /Users/matthewwhite/Code/arx
./arx -debug -show-bytecode hello.arx

# 3. Execute the program
./arxvm -debug hello.arxmod
```

### Example 2: OO Features with Debug Output
```bash
# 1. Create an OO program
cat > oo_demo.arx << 'EOF'
module OODemo;

class App
  procedure Main
  begin
    obj := new MyClass;
  end;
end;

class MyClass
  value: integer;
  
  procedure init
  begin
    value := 42;
  end;
end;
EOF

# 2. Compile with full debug output
cd /Users/matthewwhite/Code/arx
./arx -debug -show-bytecode -show-symbols oo_demo.arx

# 3. Inspect the generated module
./arxmod_info -sections oo_demo.arxmod
./arxmod_info -hex oo_demo.arxmod

# 4. Execute with debug output
./arxvm -debug oo_demo.arxmod
```

### Example 3: Inheritance and Method Overriding
```bash
# 1. Create an inheritance program
cat > inheritance.arx << 'EOF'
module InheritanceDemo;

class App
  procedure Main
  begin
    parent := new ParentClass;
    child := new ChildClass;
    
    parent.sayHello();
    child.sayHello();
  end;
end;

class ParentClass
  procedure sayHello
  begin
    WriteLn('Hello from Parent');
  end;
end;

class ChildClass extends ParentClass
  procedure sayHello
  begin
    WriteLn('Hello from Child - OVERRIDDEN!');
  end;
end;
EOF

# 2. Compile and debug
cd /Users/matthewwhite/Code/arx
./arx -debug -show-symbols inheritance.arx

# 3. Execute
./arxvm -debug inheritance.arxmod
```

## Quick Reference Commands

### From Project Root
```bash
# Compile
./arx -debug program.arx

# Execute
./arxvm -debug program.arxmod

# Test hello world with variables
./arx examples/01_hello_world.arx && ./arxvm examples/01_hello_world.arxmod

# Test arithmetic with string output
./arx examples/02_arithmetic.arx && ./arxvm examples/02_arithmetic.arxmod

# Inspect
./arxmod_info -sections program.arxmod
```

### Using Absolute Paths
```bash
# Compile
/Users/matthewwhite/Code/arx/arx -debug program.arx

# Execute
/Users/matthewwhite/Code/arx/arxvm -debug program.arxmod

# Inspect
/Users/matthewwhite/Code/arx/arxmod_info -sections program.arxmod
```

## Common Issues and Solutions

### Issue: "No such file or directory"
**Solution**: Make sure you're in the correct directory or use absolute paths
```bash
# Check current directory
pwd

# Use absolute paths
/Users/matthewwhite/Code/arx/build/arx program.arx
```

### Issue: "Permission denied"
**Solution**: Make sure the executables have execute permissions
```bash
# Make executable
chmod +x /Users/matthewwhite/Code/arx/arx
chmod +x /Users/matthewwhite/Code/arx/arxvm
chmod +x /Users/matthewwhite/Code/arx/arxmod_info
```

### Issue: "Failed to load ARX module"
**Solution**: Check if the .arxmod file was created successfully
```bash
# Check if file exists
ls -la program.arxmod

# Inspect the module
./arxmod_info -info program.arxmod
```

## Building the Tools

### Build Compiler
```bash
cd /Users/matthewwhite/Code/arx/build
make clean
make
```

### Build VM
```bash
cd /Users/matthewwhite/Code/arx/vm
make clean
make
```

**Note**: All executables (`arx`, `arxvm`, `arxmod_info`) are now built into the project root directory for maximum convenience.

## Environment Setup

### Add to PATH (Optional)
```bash
# Add to your shell profile (.bashrc, .zshrc, etc.)
export PATH="/Users/matthewwhite/Code/arx:$PATH"

# Then you can use commands directly
arx -debug program.arx
arxvm -debug program.arxmod
arxmod_info -sections program.arxmod
```

### Create Aliases (Optional)
```bash
# Add to your shell profile
alias arx-compile='cd /Users/matthewwhite/Code/arx && ./arx'
alias arx-run='cd /Users/matthewwhite/Code/arx && ./arxvm'
alias arx-info='cd /Users/matthewwhite/Code/arx && ./arxmod_info'

# Then use
arx-compile -debug program.arx
arx-run -debug program.arxmod
arx-info -sections program.arxmod
```

## Testing Commands

### Run Test Programs
```bash
# Test basic compilation
cd /Users/matthewwhite/Code/arx/build
./arx -debug ../compiler/test/basic_output_test.arx

# Test OO features
./arx -debug -show-symbols ../compiler/test/inheritance_test.arx

# Test VM execution
cd /Users/matthewwhite/Code/arx/vm
./arxvm -debug ../compiler/test/basic_output_test.arxmod
```

### Available Test Programs
- `../compiler/test/basic_output_test.arx` - Basic output test
- `../compiler/test/inheritance_test.arx` - Inheritance and method overriding
- `../compiler/test/new_integration_test.arx` - NEW expression integration
- `../compiler/test/constructor_test.arx` - Constructor parameters
- `../compiler/test/oo_demo.arx` - Complete OO features demo

## Summary

### Essential Commands
1. **Compile**: `cd build && ./arx -debug program.arx`
2. **Execute**: `cd vm && ./arxvm -debug program.arxmod`
3. **Inspect**: `cd build && ./arxmod_info -sections program.arxmod`

### Debug Commands
1. **Full Debug**: `./arx -debug -show-bytecode -show-symbols program.arx`
2. **VM Debug**: `./arxvm -debug -step program.arxmod`
3. **Module Info**: `./arxmod_info -hex program.arxmod`

### File Locations
- **Compiler**: `/Users/matthewwhite/Code/arx/arx`
- **VM**: `/Users/matthewwhite/Code/arx/arxvm`
- **Inspector**: `/Users/matthewwhite/Code/arx/arxmod_info`
